# 🛡️ AI哨兵 - 使用文档

## 📖 工具介绍

AI哨兵是一款基于大语言模型的企业级自动化渗透测试工具，专为 Burp Suite 设计的Ai插件，通过深度学习技术自动分析HTTP请求特征，智能识别潜在安全漏洞类型，动态生成针对性测试载荷，利用Burp Suite内置引擎进行精准测试，并通过AI二次验证确保漏洞真实性（置信度阈值≥90%），最终生成专业的渗透测试报告，实现了从漏洞发现到验证再到报告输出的全自动化闭环。
<img width="1917" height="927" alt="主页" src="https://github.com/user-attachments/assets/c43c2ee2-bc32-4bb7-ad1d-253fa9f57bd9" />

---

## 🌏 解压密码

** 访问官网 ** ：https://sbbbb.cn/ 在0xShe工具里寻找Backup哨兵，点击进入后获取解压密码 
<img width="1325" height="1065" alt="image" src="https://github.com/user-attachments/assets/dc6b5d79-2a53-4e24-8b66-45db3b1cc687" />

---
## ⚡ 核心功能

### 🤖 1. AI智能分析

- 自动识别Web应用技术栈（PHP/Java/Python/Node.js/.NET等）
- 智能判断可能存在的漏洞类型
- 动态生成针对性测试载荷
- 考虑WAF绕过技术

<img width="1913" height="921" alt="POC" src="https://github.com/user-attachments/assets/dac1e1db-97df-4d0a-9566-8d8190b162e2" />



### 🚀 2. 自动化测试

- 智能参数注入（支持GET/POST/JSON/XML等）
- 自动跳过CSRF/Token等特殊参数
- 使用Burp Suite内置引擎发送请求
- 收集完整的响应数据

### 🔍 3. AI验证漏洞

- 将完整响应包发送给AI分析
- AI深度分析响应内容特征
- 查找明确的漏洞证据
- 置信度≥90%才报告漏洞
- 杜绝误报

### 📄 4. 专业报告生成

- AI自动生成详细的漏洞报告
- 用大白话解释测试过程
- 包含完整的复现步骤和数据包
- 支持导出HTML/Markdown格式

### 📊 5. 任务管理

- 任务列表实时更新
- 搜索和筛选功能
- 右键菜单（重扫/删除/复制）
- 批量操作（清空已完成、批量导出）

### 📝 6. 实时日志

- 彩色分类日志（INFO/SUCCESS/WARNING/ERROR/AI）
- 实时统计（总任务/已完成/发现漏洞/正在扫描）
- 详细的AI分析过程
- 日志导出功能

<img width="1912" height="922" alt="日志" src="https://github.com/user-attachments/assets/7cb98429-73ad-4304-a01f-4a3f61a60e17" />


### ✏️ 7. 提示词管理

- 查看和编辑AI提示词
- 分析/验证/报告三类提示词
- 自定义提示词
- 恢复默认提示词

<img width="1918" height="930" alt="提示词" src="https://github.com/user-attachments/assets/cc3c8bb4-061d-40a8-89e2-4d347feaf5c6" />


### ⚙️ 8. 端点配置管理

- 预设15+个主流AI服务商
- 自定义AI端点
- 增删改查端点配置
- 内置端点可编辑

---

## 🎯 使用步骤

### 🔧 第一步：配置AI服务

1. 点击右上角「打开配置」按钮
2. 在「AI服务」下拉框选择AI服务商：
   - OpenAI
   - Anthropic (Claude)
   - 通义千问
   - 文心一言
   - 智谱AI
   - 或选择「自定义」手动输入端点
3. 输入你的API Key
4. 点击「获取模型」按钮，系统会：
   - 自动识别AI服务类型
   - 设置正确的认证头
   - 获取可用模型列表
5. 在「选择模型」下拉框选择模型
6. 点击「保存配置」
7. 点击「验证Key」确认配置正确

配置会自动保存到 `~/.aisb_config.json`，下次启动自动加载。

### 📡 第二步：发送测试

1. 在Burp Suite任何位置（Proxy/Repeater/Target等）
2. 右键点击要测试的HTTP请求
3. 选择「发送到 AI哨兵」
4. 系统自动开始测试

支持批量发送：选中多个请求，右键批量发送。

<img width="728" height="403" alt="发送请求" src="https://github.com/user-attachments/assets/5029c33e-7d58-4720-b7d0-d51b008872c2" />


### 👀 第三步：查看结果

切换到AI哨兵的不同标签页：

**任务列表**：

- 查看所有扫描任务
- 使用搜索框和筛选器快速定位
- 右键菜单操作任务
- 批量导出报告

**漏洞报告**：

- 查看AI生成的详细报告
- 大白话解释测试过程
- 包含完整复现步骤
- 导出HTML/MD格式

**任务详情**：

- 查看漏洞摘要信息
- 使用Burp原生编辑器查看请求/响应包
- 支持右键菜单和所有Burp功能

**日志统计**：

- 实时查看AI分析过程
- 统计仪表盘
- 导出日志

**提示词**：

- 查看和修改AI提示词
- 优化AI分析效果

**使用介绍**：

- 查看工具说明

### 💾 第四步：导出报告

点击「导出报告」按钮，可以：

- 导出选中任务或全部任务
- 按危险等级筛选（严重/高危/中危/低危）
- 按漏洞类型筛选（SQL注入/XSS/RCE等）
- 选择导出格式（HTML/Markdown）
<img width="1918" height="930" alt="提示词" src="https://github.com/user-attachments/assets/8e77b8d6-0234-40f1-968b-0f4f184bdca8" />

---

## 🔑 配置说明

### 🌐 API配置

支持25+个主流AI服务：

**国外服务**：

- OpenAI（GPT系列）
- Anthropic（Claude系列）
- Google Gemini
- Azure OpenAI
- Mistral AI
- 等

**国内服务**：

- 阿里云通义千问
- 百度文心一言
- 智谱AI
- 月之暗面Kimi
- DeepSeek
- 讯飞星火
- 字节豆包
- 腾讯混元
- 等

### 🔌 端点管理

点击「管理端点」可以：

- 查看所有内置和自定义端点
- 新增自定义端点
- 编辑端点配置
- 删除自定义端点

### 💬 提示词自定义

在「提示词」标签页可以：

- 修改分析提示词（控制AI如何分析请求）
- 修改验证提示词（控制AI如何判断漏洞）
- 修改报告提示词（控制AI如何生成报告）
- 保存自定义提示词
- 恢复默认提示词

---

## ✨ 工具特点

### 🧠 1. 完全AI驱动

**传统扫描器**：

- 预设漏洞规则
- 固定测试载荷
- 基于特征匹配
- 误报率高

**AI哨兵**：

- AI动态分析
- 智能生成载荷
- AI深度验证
- 误报率<5%

### ✅ 2. 零误报保证

- AI二次验证机制
- 分析完整响应内容
- 查找明确的漏洞证据
- 置信度≥90%才报告
- 不是简单的关键词匹配

### 🌍 3. 支持所有技术栈

- PHP应用
- Java应用（Spring/Struts）
- Python应用（Django/Flask）
- Node.js应用
- .NET应用
- Go应用
- 等所有Web技术栈

### 💡 4. 智能化

- 自动识别技术栈
- 自动生成针对性载荷
- 自动跳过无用参数
- 自动深度测试
- 自动生成报告

### 🛡️ 5. 无害化测试

所有测试载荷都经过无害化设计：

- 文件上传：不上传webshell，使用输出固定内容的文件
- 命令注入：使用whoami、id等无害命令
- SQL注入：使用查询测试，不使用DROP/DELETE
- XSS：使用alert(1)等无害测试
- 不会对目标系统造成破坏

### 💰 6. 高效节约

- 只测试可疑接口
- AI判断是否需要测试
- 避免无效请求
- 节省Token成本
- 平均每个请求1000-3000 tokens

---

## 🔄 工具逻辑

### 📋 完整测试流程

```
1. 用户右键发送请求
   ↓
2. AI分析请求特征
   - 识别技术栈
   - 识别参数位置和类型
   - 判断可能的漏洞类型
   - 生成2-5个测试载荷
   ↓
3. 自动化测试
   - 智能参数注入
   - 发送测试请求
   - 收集完整响应
   ↓
4. AI验证漏洞
   - 分析完整响应内容
   - 查找漏洞利用成功的证据
   - 判断置信度
   - 只有≥90%才报告
   ↓
5. 生成报告
   - AI生成详细报告
   - 包含测试过程
   - 包含复现步骤
   - 包含完整数据包
   ↓
6. 展示结果
   - 任务列表更新
   - 漏洞报告生成
   - 实时日志输出
```

### 🧩 AI分析逻辑

**🔍 分析阶段**：

```
输入：原始HTTP请求
AI分析：
  - 请求方法和URL
  - 参数位置和类型
  - 技术栈特征
  - 可能的漏洞类型
输出：测试载荷列表
```

**✔️ 验证阶段**：

```
输入：
  - 原始请求
  - 测试载荷
  - 完整响应包
AI验证：
  - 分析响应状态
  - 分析响应内容
  - 查找漏洞证据
  - 评估置信度
输出：
  - 是否存在漏洞
  - 置信度（0-100）
  - 漏洞等级
  - 详细描述
```

**📝 报告阶段**：

```
输入：
  - 漏洞类型
  - 测试载荷
  - 响应内容
  - 验证结果
AI生成：
  - 漏洞发现过程
  - 详细测试过程
  - 响应特征分析
  - 漏洞证明
  - 复现步骤
  - 复现数据包
输出：Markdown格式报告
```

---

## 🎯 支持的漏洞类型

- SQL注入（SQL Injection）
- XSS跨站脚本（Cross-Site Scripting）
- RCE远程代码执行（Remote Code Execution）
- 任意文件上传（File Upload）
- SSRF服务端请求伪造（Server-Side Request Forgery）
- XXE外部实体注入（XML External Entity）
- 命令注入（Command Injection）
- 路径遍历（Path Traversal）
- IDOR不安全的直接对象引用（Insecure Direct Object Reference）
- CSRF跨站请求伪造（Cross-Site Request Forgery）
- 本地文件包含（LFI）
- 远程文件包含（RFI）
- 模板注入（SSTI）
- 反序列化漏洞（Deserialization）
- 等

---

## 👨‍💻 作者信息

**🔧 工具名称**：AI哨兵

**👥 开发团队**：0xShe

**📌 版本**：v1.0.0

---

## ⚠️ 免责声明

### ⚖️ 法律声明

1. **授权要求**：本工具仅供合法授权的渗透测试使用。使用者必须在测试前获得目标系统所有者的明确书面授权。

2. **法律责任**：未经授权对计算机系统进行渗透测试属于违法行为。使用者需自行承担因使用本工具产生的一切法律责任。

3. **免责条款**：开发者不对任何未授权使用、非法使用或滥用本工具的行为承担责任。

### 📜 使用规范

- 必须遵守当地法律法规和网络安全法
- 必须在授权范围内进行测试
- 禁止对未授权目标进行测试
- 禁止使用本工具进行任何破坏性操作
- 发现漏洞后应及时通知相关方修复

### 🔒 数据安全

- 请求和响应数据会发送至AI服务商进行分析
- 避免测试包含敏感信息的接口
- 妥善保管API密钥
- 了解并遵守AI服务商的使用条款

---

## 🔬 技术特性

### 🤖 AI技术

- 支持25+个主流AI服务
- 智能认证头识别
- 支持多种API响应格式
- 自动适配不同模型

### 🔐 安全性

- 无害化测试载荷
- 不会破坏目标系统
- 完善的异常处理
- 详细的错误日志

### ⚡ 性能

- 并发测试支持（3个线程）
- 智能Token优化
- 避免重复测试
- 平均每个请求30-60秒

### 🎯 准确性

- AI二次验证
- 置信度阈值≥90%
- 分析完整响应
- 预期误报率<5%

---

**🎉 AI哨兵 - 让渗透测试更智能 🚀**
